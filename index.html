<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¾æ¥­ LINE@ ä¸€ç«™å¼æœå‹™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background: linear-gradient(135deg, #f5e6d3, #e8d5c4);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* èƒŒæ™¯èŠ±æœµè£é£¾ */
        .flower-bg {
            position: absolute;
            top: -100px;
            right: -100px;
            width: 400px;
            height: 400px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><g fill="%23f4f1ec" opacity="0.3"><ellipse cx="100" cy="60" rx="25" ry="45" transform="rotate(0 100 100)"/><ellipse cx="100" cy="60" rx="25" ry="45" transform="rotate(72 100 100)"/><ellipse cx="100" cy="60" rx="25" ry="45" transform="rotate(144 100 100)"/><ellipse cx="100" cy="60" rx="25" ry="45" transform="rotate(216 100 100)"/><ellipse cx="100" cy="60" rx="25" ry="45" transform="rotate(288 100 100)"/><circle cx="100" cy="100" r="15" fill="%23d4a574"/></g></svg>') no-repeat center;
            background-size: contain;
            z-index: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
        }

        .header h1 {
            color: #8b4513;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #a0522d;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* å°èˆªé¸å–® */
        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-tab {
            background: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            color: #8b4513;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.1);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
        }

        .nav-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.15);
        }

        /* å…§å®¹å€å¡Š */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* è¼‰å…¥å‹•ç•« */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #8b4513;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #8b4513;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ç¯„æœ¬å¡ç‰‡ç¶²æ ¼ */
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .template-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .template-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d4a574, #deb887);
        }

        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(139, 69, 19, 0.15);
            border-color: #d4a574;
        }

        /* é¡å‹æ¨™ç±¤ */
        .type-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            z-index: 2;
        }

        .type-badge.free {
            background: #28a745;
            color: white;
        }

        .type-badge.vip {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #8b4513;
        }

        .type-badge.limited {
            background: linear-gradient(135deg, #ff69b4, #ff8fa3);
            color: white;
        }

        .type-badge.designer {
            background: linear-gradient(135deg, #8a2be2, #9932cc);
            color: white;
        }

        .template-preview {
            width: 100%;
            height: 200px;
            background: #f8f6f0;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #d4a574;
            position: relative;
        }

        .template-preview img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
        }

        .template-preview::after {
            content: 'è¼‰å…¥ä¸­...';
            color: #a0522d;
            font-size: 0.9rem;
            opacity: 0.6;
            position: absolute;
        }

        .template-preview:has(img)::after {
            display: none;
        }

        .template-info h3 {
            color: #8b4513;
            font-size: 1.3rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .template-info p {
            color: #a0522d;
            font-size: 0.95rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* åƒ¹æ ¼é¡¯ç¤º */
        .price-info {
            margin-bottom: 15px;
        }

        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 0.9rem;
            margin-right: 8px;
        }

        .sale-price {
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .free-price {
            color: #28a745;
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .download-btn, .premium-btn {
            width: 100%;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .download-btn {
            background: linear-gradient(135deg, #28a745, #34ce57);
            color: white;
        }

        .download-btn:hover {
            background: linear-gradient(135deg, #34ce57, #28a745);
            transform: scale(1.02);
        }

        .premium-btn {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
        }

        .premium-btn:hover {
            background: linear-gradient(135deg, #a0522d, #8b4513);
            transform: scale(1.02);
        }

        /* æœå‹™å€å¡Š */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .service-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.1);
            text-align: center;
        }

        .service-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .service-card h3 {
            color: #8b4513;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .service-card p {
            color: #a0522d;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .service-btn {
            background: linear-gradient(135deg, #d4a574, #8b4513);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .service-btn:hover {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            transform: scale(1.05);
        }

        /* å½ˆçª—æ¨£å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal h3 {
            color: #8b4513;
            margin-bottom: 20px;
        }

        .modal input {
            width: 100%;
            padding: 12px;
            border: 2px solid #d4a574;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 1rem;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
        }

        .modal-btn.secondary {
            background: #f8f6f0;
            color: #8b4513;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #8b4513;
        }

        /* é ‚éƒ¨ä¿ƒéŠ·æ©«å¹… */
        .promo-banner {
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            text-align: center;
            padding: 12px 20px;
            position: relative;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-100%);
                opacity: 0;
            }
        }

        .promo-banner.hidden {
            display: none;
        }

        .promo-text {
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .promo-banner .close-banner {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .promo-banner .close-banner:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .promo-cta {
            background: white;
            color: #ff6b6b;
            padding: 6px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .promo-cta:hover {
            background: #f0f0f0;
            transform: scale(1.05);
        }

        /* æµ®å‹•LINEæŒ‰éˆ• */
        .floating-line-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #00B900;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 185, 0, 0.4);
            z-index: 999;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .floating-line-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(0, 185, 0, 0.6);
        }

        .floating-line-btn::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #00B900;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.4);
                opacity: 0;
            }
        }

        .floating-line-btn svg {
            width: 32px;
            height: 32px;
            fill: white;
            z-index: 1;
            position: relative;
        }

        /* é å°¾å€å¡Š */
        .footer {
            background: rgba(255, 255, 255, 0.9);
            margin-top: 60px;
            padding: 40px 20px;
            text-align: center;
            border-top: 1px solid rgba(139, 69, 19, 0.1);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-section {
            margin-bottom: 30px;
        }

        .footer-section h4 {
            color: #8b4513;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .footer-section p {
            color: #a0522d;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .footer-contacts {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: white;
            border-radius: 25px;
            text-decoration: none;
            color: #8b4513;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.1);
            transition: all 0.3s ease;
        }

        .contact-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.15);
            color: #8b4513;
            text-decoration: none;
        }

        .contact-item.line {
            background: #00B900;
            color: white;
        }

        .contact-item.line:hover {
            color: white;
        }

        .footer-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, #d4a574, transparent);
            margin: 30px 0;
        }

        .footer-bottom {
            color: #a0522d;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* æ•™å­¸å½±ç‰‡å€å¡Š */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .video-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(139, 69, 19, 0.15);
            border-color: #d4a574;
        }

        .video-preview {
            width: 100%;
            height: 180px;
            background: #f8f6f0;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #d4a574;
            position: relative;
        }

        .play-icon {
            width: 60px;
            height: 60px;
            background: rgba(139, 69, 19, 0.8);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            position: absolute;
            z-index: 2;
        }

        .watch-btn {
            width: 100%;
            background: linear-gradient(135deg, #d4a574, #8b4513);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .watch-btn:hover {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            transform: scale(1.02);
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .templates-grid, .services-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .template-card, .service-card {
                padding: 20px;
            }

            .nav-tabs {
                justify-content: center;
            }

            .nav-tab {
                font-size: 0.9rem;
                padding: 10px 18px;
            }
        }
    </style>
</head>
<body>
    <!-- é ‚éƒ¨ä¿ƒéŠ·æ©«å¹… -->
    <div class="promo-banner" id="promoBanner">
        <div class="promo-text">
            <span>ğŸ‰</span>
            <span>é™æ™‚å„ªæƒ ï¼å…¨é¤¨VIPç¯„æœ¬é™æ™‚8æŠ˜ï¼ŒéŒ¯éå°±æ²’äº†ï¼</span>
            <a href="#" class="promo-cta" onclick="addLineOfficial()">
                ğŸ“± ç«‹å³åŠ LINE
            </a>
        </div>
        <button class="close-banner" onclick="closeBanner()" title="é—œé–‰æ©«å¹…">Ã—</button>
    </div>

    <div class="flower-bg"></div>
    
    <div class="container">
        <div class="header">
            <h1>ç¾æ¥­ LINE@ ä¸€ç«™å¼æœå‹™</h1>
            <p>å°ˆæ¥­ç¯„æœ¬ã€æ•™å­¸èª²ç¨‹ã€å®¢è£½æœå‹™ï¼Œä¸€ç«™å¼è§£æ±ºæ–¹æ¡ˆ</p>
        </div>

        <!-- å°èˆªé¸å–® -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('templates')">ğŸ“± ç²¾é¸ç¯„æœ¬</button>
            <button class="nav-tab" onclick="showSection('tutorials')">ğŸ“ ç·šä¸Šæ•™å­¸</button>
            <button class="nav-tab" onclick="showSection('services')">ğŸ’¼ å°ˆæ¥­æœå‹™</button>
        </div>

        <!-- ç¯„æœ¬ä¸‹è¼‰å€å¡Š -->
        <div id="templates" class="content-section active">
            <div class="loading" id="templates-loading">
                <div class="loading-spinner"></div>
                <p>æ­£åœ¨è¼‰å…¥ç²¾é¸ç¯„æœ¬...</p>
            </div>
            <div class="templates-grid" id="templates-grid"></div>
        </div>

        <!-- ç·šä¸Šæ•™å­¸å€å¡Š -->
        <div id="tutorials" class="content-section">
            <h2 style="text-align: center; color: #8b4513; margin-bottom: 30px;">ğŸ“ ç·šä¸Šæ•™å­¸èª²ç¨‹</h2>
            
            <h3 style="color: #8b4513; margin-bottom: 20px;">ğŸ å…è²»æ•™å­¸</h3>
            <div class="video-grid">
                <div class="video-card" onclick="watchFreeVideo('basic-setup')">
                    <div class="video-preview">
                        <div class="play-icon">â–¶</div>
                    </div>
                    <div class="template-info">
                        <h3>LINE@ åŸºç¤è¨­å®š</h3>
                        <p>å¾é›¶é–‹å§‹å­¸ç¿’LINE@å®˜æ–¹å¸³è™Ÿçš„åŸºæœ¬è¨­å®šå’Œæ“ä½œ</p>
                    </div>
                    <button class="watch-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        å…è²»è§€çœ‹
                    </button>
                </div>

                <div class="video-card" onclick="watchFreeVideo('menu-upload')">
                    <div class="video-preview">
                        <div class="play-icon">â–¶</div>
                    </div>
                    <div class="template-info">
                        <h3>åœ–æ–‡é¸å–®ä¸Šå‚³æ•™å­¸</h3>
                        <p>è©³ç´°æ­¥é©Ÿæ•™ä½ å¦‚ä½•ä¸Šå‚³å’Œè¨­å®šåœ–æ–‡é¸å–®</p>
                    </div>
                    <button class="watch-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        å…è²»è§€çœ‹
                    </button>
                </div>
            </div>

            <h3 style="color: #8b4513; margin: 40px 0 20px 0;">ğŸ’ é€²éšä»˜è²»æ•™å­¸</h3>
            <div class="video-grid">
                <div class="video-card" onclick="verifyAndWatchVideo('TUTORIAL-001')">
                    <div class="type-badge vip">ğŸ’ VIP</div>
                    <div class="video-preview">
                        <div class="play-icon">â–¶</div>
                    </div>
                    <div class="template-info">
                        <h3>é€²éšè¡ŒéŠ·æŠ€å·§</h3>
                        <p>å­¸ç¿’å¦‚ä½•é€éLINE@æå‡å®¢æˆ¶äº’å‹•å’Œè½‰æ›ç‡</p>
                    </div>
                    <div class="price-info">
                        <span class="original-price">$299</span>
                        <span class="sale-price">é™æ™‚ $199</span>
                    </div>
                    <button class="premium-btn">
                        ğŸ’ ä»˜è²»è§€çœ‹
                    </button>
                </div>

                <div class="video-card" onclick="verifyAndWatchVideo('TUTORIAL-002')">
                    <div class="type-badge vip">ğŸ’ VIP</div>
                    <div class="video-preview">
                        <div class="play-icon">â–¶</div>
                    </div>
                    <div class="template-info">
                        <h3>æ•¸æ“šåˆ†æèˆ‡å„ªåŒ–</h3>
                        <p>æ·±å…¥äº†è§£LINE@å¾Œå°æ•¸æ“šï¼Œå„ªåŒ–ç‡Ÿé‹ç­–ç•¥</p>
                    </div>
                    <div class="price-info">
                        <span class="original-price">$299</span>
                        <span class="sale-price">é™æ™‚ $199</span>
                    </div>
                    <button class="premium-btn">
                        ğŸ’ ä»˜è²»è§€çœ‹
                    </button>
                </div>
            </div>
        </div>

        <!-- å°ˆæ¥­æœå‹™å€å¡Š -->
        <div id="services" class="content-section">
            <h2 style="text-align: center; color: #8b4513; margin-bottom: 30px;">ğŸ’¼ å°ˆæ¥­å®¢è£½æœå‹™</h2>
            
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon">ğŸ¨</div>
                    <h3>LINE å®¢è£½è¨­è¨ˆ</h3>
                    <p>
                        å°ˆæ¥­è¨­è¨ˆå¸«ç‚ºæ‚¨é‡èº«æ‰“é€ ç¨ç‰¹çš„åœ–æ–‡é¸å–®<br>
                        ãƒ»å®Œå…¨å®¢è£½åŒ–è¨­è¨ˆ<br>
                        ãƒ»ç¬¦åˆå“ç‰Œé¢¨æ ¼<br>
                        ãƒ»3-5å€‹å·¥ä½œå¤©äº¤ä»˜
                    </p>
                    <div class="price-info">
                        <span class="original-price">$2,999</span>
                        <span class="sale-price">é™æ™‚ $1,999</span>
                    </div>
                    <button class="service-btn" onclick="contactService('custom-design')">
                        ç«‹å³è«®è©¢
                    </button>
                </div>

                <div class="service-card">
                    <div class="service-icon">âš™ï¸</div>
                    <h3>å°ˆäººå”åŠ©è¨­å®š</h3>
                    <p>
                        é ç«¯å”åŠ©å®Œæ•´è¨­å®šæ‚¨çš„LINE@å®˜æ–¹å¸³è™Ÿ<br>
                        ãƒ»ä¸€å°ä¸€æ•™å­¸è¨­å®š<br>
                        ãƒ»å®Œæ•´åŠŸèƒ½é…ç½®<br>
                        ãƒ»ç•¶æ—¥å®Œæˆæœå‹™
                    </p>
                    <div class="price-info">
                        <span class="original-price">$999</span>
                        <span class="sale-price">é™æ™‚ $799</span>
                    </div>
                    <button class="service-btn" onclick="contactService('setup-service')">
                        ç«‹å³é ç´„
                    </button>
                </div>

                <div class="service-card">
                    <div class="service-icon">ğŸ“Š</div>
                    <h3>ç‡Ÿé‹è«®è©¢æœå‹™</h3>
                    <p>
                        å°ˆæ¥­é¡§å•å”åŠ©è¦åŠƒLINE@ç‡Ÿé‹ç­–ç•¥<br>
                        ãƒ»ä¸€å°ä¸€ç­–ç•¥è«®è©¢<br>
                        ãƒ»å®¢è£½åŒ–å»ºè­°æ–¹æ¡ˆ<br>
                        ãƒ»æŒçºŒè¿½è¹¤å„ªåŒ–
                    </p>
                    <div class="price-info">
                        <span class="sale-price">$1,499 èµ·</span>
                    </div>
                    <button class="service-btn" onclick="contactService('consulting')">
                        äº†è§£æ›´å¤š
                    </button>
                </div>
            </div>
        </div>

        <!-- é å°¾è¯çµ¡å€å¡Š -->
        <div class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ğŸŒ¸ ç¾æ¥­ LINE@ ä¸€ç«™å¼æœå‹™</h4>
                    <p>å°ˆæ¥­çš„åœ–æ–‡é¸å–®è¨­è¨ˆèˆ‡LINE@ç‡Ÿé‹è§£æ±ºæ–¹æ¡ˆ</p>
                    <p>è®“æ‚¨çš„ç¾å®¹äº‹æ¥­åœ¨æ•¸ä½è¡ŒéŠ·ä¸Šæ›´é€²ä¸€æ­¥</p>
                </div>

                <div class="footer-contacts">
                    <a href="#" class="contact-item line" onclick="addLineOfficial()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.628-.629.628M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/>
                        </svg>
                        LINE å®˜æ–¹å®¢æœ
                    </a>
                    
                    <a href="mailto:service@example.com" class="contact-item">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                        å®¢æœä¿¡ç®±
                    </a>

                    <a href="tel:+886-2-1234-5678" class="contact-item">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                        </svg>
                        æœå‹™å°ˆç·š
                    </a>
                </div>

                <div class="footer-divider"></div>

                <div class="footer-section">
                    <h4>ğŸ“‹ æœå‹™é …ç›®</h4>
                    <p>âœ¨ LINE@ åœ–æ–‡é¸å–®è¨­è¨ˆ | ğŸ“ ç·šä¸Šæ•™å­¸èª²ç¨‹ | ğŸ› ï¸ å®¢è£½åŒ–æœå‹™</p>
                    <p>âš™ï¸ å°ˆäººå”åŠ©è¨­å®š | ğŸ“Š ç‡Ÿé‹è«®è©¢é¡§å• | ğŸ¯ æ•¸ä½è¡ŒéŠ·ç­–ç•¥</p>
                </div>

                <div class="footer-divider"></div>

                <div class="footer-bottom">
                    <p>Â© 2024 ç¾æ¥­ LINE@ ä¸€ç«™å¼æœå‹™. All rights reserved.</p>
                    <p>è®“æ‚¨çš„ç¾å®¹äº‹æ¥­åœ¨æ•¸ä½æ™‚ä»£é–ƒé–ƒç™¼å…‰ âœ¨</p>
                </div>
            </div>
        </div>
    </div>

    <!-- æµ®å‹•LINEæŒ‰éˆ• -->
    <a href="#" class="floating-line-btn" onclick="addLineOfficial()" title="åŠ å…¥LINEå®˜æ–¹å®¢æœ">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.628-.629.628M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/>
        </svg>
    </a>

    <!-- Email é©—è­‰å½ˆçª— -->
    <div id="emailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3>ğŸ” è«‹è¼¸å…¥é©—è­‰ Email</h3>
            <p id="modal-message">è«‹è¼¸å…¥æ‚¨å·²è³¼è²·æ­¤ç¯„æœ¬çš„ Email åœ°å€</p>
            <input type="email" id="emailInput" placeholder="è«‹è¼¸å…¥æ‚¨çš„ Email">
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="modal-btn primary" onclick="verifyEmail()">é©—è­‰ä¸‹è¼‰</button>
            </div>
        </div>
    </div>

    <!-- è³¼è²·èªªæ˜å½ˆçª— -->
    <div id="purchaseModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePurchaseModal()">&times;</span>
            <h3>ğŸ’ ä»˜è²»ç¯„æœ¬è³¼è²·èªªæ˜</h3>
            <div style="text-align: left; margin: 20px 0;">
                <h4 style="color: #8b4513; margin-bottom: 10px;">ğŸ“‹ è³¼è²·æ­¥é©Ÿï¼š</h4>
                <p>1ï¸âƒ£ åŠ å…¥LINEå®˜æ–¹ï¼š<strong>@your_line_id</strong></p>
                <p>2ï¸âƒ£ å‘ŠçŸ¥è¦è³¼è²·çš„ç¯„æœ¬ç·¨è™Ÿ</p>
                <p>3ï¸âƒ£ å®Œæˆä»˜æ¬¾å¾Œæä¾›æ‚¨çš„ Email</p>
                <p>4ï¸âƒ£ 24å°æ™‚å…§é–‹é€šä¸‹è¼‰æ¬Šé™</p>
            </div>
            <div style="margin: 20px 0;">
                <p>ğŸ’° <strong id="purchase-price">å–®æ¬¾ $499</strong></p>
                <p>âœ… ä¸€æ¬¡è³¼è²·ï¼Œæ°¸ä¹…ä¸‹è¼‰</p>
            </div>
            <button class="modal-btn primary" onclick="addLineOfficial()" style="width: 100%; margin-top: 20px;">
                ğŸ“± åŠ å…¥LINEå®˜æ–¹è³¼è²·
            </button>
        </div>
    </div>

    <script>
        // åŠŸèƒ½é–‹é—œ
        const FEATURES = {
            showIndustryFilter: false,
            showPricing: true,
            showLimitedBadge: true
        };

        // Google Sheets è¨­å®š (è«‹æ›¿æ›ç‚ºä½ çš„å¯¦éš› Google Apps Script URL)
        const SHEETS_API_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
        const LINE_OFFICIAL_ID = '@your_line_id'; // è«‹æ›¿æ›ç‚ºä½ çš„LINEå®˜æ–¹å¸³è™ŸID

        let currentTemplateCode = '';
        let templatesData = [];

        // é—œé–‰ä¿ƒéŠ·æ©«å¹…
        function closeBanner() {
            const banner = document.getElementById('promoBanner');
            banner.style.animation = 'slideUp 0.3s ease-out forwards';
            setTimeout(() => {
                banner.classList.add('hidden');
            }, 300);
            
            // è¨˜ä½ä½¿ç”¨è€…å·²é—œé–‰æ©«å¹…
            localStorage.setItem('promoBannerClosed', 'true');
        }

        // æª¢æŸ¥æ˜¯å¦è¦é¡¯ç¤ºæ©«å¹…
        function checkBannerVisibility() {
            const bannerClosed = localStorage.getItem('promoBannerClosed');
            if (bannerClosed === 'true') {
                document.getElementById('promoBanner').classList.add('hidden');
            }
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            checkBannerVisibility();
            loadTemplates();
        });

        // å°èˆªåˆ‡æ›
        function showSection(sectionId) {
            // éš±è—æ‰€æœ‰å€å¡Š
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰ active é¡åˆ¥
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // é¡¯ç¤ºé¸ä¸­çš„å€å¡Š
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // è¼‰å…¥ç¯„æœ¬è³‡æ–™
        async function loadTemplates() {
            try {
                // æš«æ™‚ç›´æ¥è¼‰å…¥ç¤ºç¯„è³‡æ–™ï¼Œä¹‹å¾Œå¯æ”¹ç‚º API å‘¼å«
                loadDemoTemplates();
                
                /* 
                // æ­£å¼ç‰ˆæœ¬çš„ API å‘¼å«
                const response = await fetch(`${SHEETS_API_URL}?action=getTemplates`);
                const data = await response.json();
                
                if (data.success) {
                    templatesData = data.templates;
                    renderTemplates(templatesData);
                    document.getElementById('templates-loading').style.display = 'none';
                } else {
                    showError('è¼‰å…¥ç¯„æœ¬å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
                }
                */
            } catch (error) {
                console.error('è¼‰å…¥ç¯„æœ¬éŒ¯èª¤:', error);
                // ç™¼ç”ŸéŒ¯èª¤æ™‚è¼‰å…¥ç¤ºç¯„è³‡æ–™
                loadDemoTemplates();
            }
        }

        // è¼‰å…¥ç¤ºç¯„è³‡æ–™ (é–‹ç™¼æ¸¬è©¦ç”¨)
        function loadDemoTemplates() {
            const demoTemplates = [
                // å…è²»ç¯„æœ¬
                {
                    ç·¨ç¢¼: 'FREE-001',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/f5e6d3/8b4513?text=æ¥µç°¡é¢¨æ ¼',
                    é¢¨æ ¼åç¨±: 'æ¥µç°¡é¢¨æ ¼',
                    ç°¡çŸ­æè¿°: 'ç°¡ç´„å¤§æ–¹çš„è¨­è¨ˆé¢¨æ ¼ï¼Œé©åˆé«˜ç«¯ç¾å®¹æ²™é¾ï¼Œå±•ç¾å°ˆæ¥­è³ªæ„Ÿ',
                    é¡å‹: 'FREE',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$0',
                    é™æ™‚åƒ¹: '$0',
                    DriveID: '1BcD2EfG3HiJ4KlM5NoPqRsT6UvW7XyZ8'
                },
                {
                    ç·¨ç¢¼: 'FREE-002',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/ffb6c1/8b4513?text=ç²‰å«©å°‘å¥³é¢¨',
                    é¢¨æ ¼åç¨±: 'ç²‰å«©å°‘å¥³é¢¨',
                    ç°¡çŸ­æè¿°: 'æº«æŸ”ç²‰è‰²ç³»è¨­è¨ˆï¼Œé©åˆå¹´è¼•å®¢ç¾¤çš„ç¾ç”²ç¾ç«åº—ï¼Œå¯æ„›ç”œç¾é¢¨æ ¼',
                    é¡å‹: 'FREE',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$0',
                    é™æ™‚åƒ¹: '$0',
                    DriveID: '2EfG3HiJ4KlM5NoPqRsT6UvW7XyZ8AbC'
                },
                {
                    ç·¨ç¢¼: 'FREE-003',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/f4a460/ffffff?text=æº«é¦¨æš–è‰²é¢¨',
                    é¢¨æ ¼åç¨±: 'æº«é¦¨æš–è‰²é¢¨',
                    ç°¡çŸ­æè¿°: 'æš–æ©˜è‰²ç³»è¨­è¨ˆï¼Œç‡Ÿé€ è¦ªåˆ‡æº«é¦¨æ„Ÿï¼Œé©åˆç¤¾å€å‹ç¾å®¹ç¾é«®åº—',
                    é¡å‹: 'FREE',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$0',
                    é™æ™‚åƒ¹: '$0',
                    DriveID: '3GhI4JkL5MnO6PqR7StU8VwX9YzA0BcD'
                },
                // VIP ç¯„æœ¬
                {
                    ç·¨ç¢¼: 'VIP-001',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/ffd700/8b4513?text=å¥¢è¯é‡‘è‰²é¢¨',
                    é¢¨æ ¼åç¨±: 'å¥¢è¯é‡‘è‰²é¢¨',
                    ç°¡çŸ­æè¿°: 'é‡‘è‰²è³ªæ„Ÿè¨­è¨ˆï¼Œé©åˆé ‚ç´šç¾å®¹ä¸­å¿ƒï¼Œå½°é¡¯å°Šè²´èˆ‡å°ˆæ¥­å½¢è±¡',
                    é¡å‹: 'VIP',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$699',
                    é™æ™‚åƒ¹: '$499',
                    DriveID: '4JkL5MnO6PqR7StU8VwX9YzA0BcD1EfG'
                },
                {
                    ç·¨ç¢¼: 'VIP-002',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/9370db/ffffff?text=å„ªé›…ç´«è‰²é¢¨',
                    é¢¨æ ¼åç¨±: 'å„ªé›…ç´«è‰²é¢¨',
                    ç°¡çŸ­æè¿°: 'ç¥ç§˜å„ªé›…çš„ç´«è‰²èª¿ï¼Œé©åˆæŠ—è€é†«ç¾è¨ºæ‰€ï¼Œå±•ç¾å°ˆæ¥­èˆ‡ç¥ç§˜æ„Ÿ',
                    é¡å‹: 'VIP',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$699',
                    é™æ™‚åƒ¹: '$499',
                    DriveID: '5MnO6PqR7StU8VwX9YzA0BcD1EfG2HiJ'
                },
                {
                    ç·¨ç¢¼: 'VIP-003',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/2f4f4f/ffffff?text=æ™‚å°šé»‘ç™½é¢¨',
                    é¢¨æ ¼åç¨±: 'æ™‚å°šé»‘ç™½é¢¨',
                    ç°¡çŸ­æè¿°: 'ç¶“å…¸é»‘ç™½é…è‰²ï¼Œé©åˆæ½®æµç¾é«®æ²™é¾ï¼Œå±•ç¾æ™‚å°šå‰è¡›çš„å“ç‰Œèª¿æ€§',
                    é¡å‹: 'VIP',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$699',
                    é™æ™‚åƒ¹: '$499',
                    DriveID: '6PqR7StU8VwX9YzA0BcD1EfG2HiJ3KlM'
                },
                {
                    ç·¨ç¢¼: 'VIP-004',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/8fbc8f/8b4513?text=è‡ªç„¶ç¶ æ„é¢¨',
                    é¢¨æ ¼åç¨±: 'è‡ªç„¶ç¶ æ„é¢¨',
                    ç°¡çŸ­æè¿°: 'æ¸…æ–°è‡ªç„¶è‰²èª¿ï¼Œé©åˆä¸»æ‰“æœ‰æ©Ÿå¤©ç„¶è­·è†šçš„ç¾å®¹é™¢ï¼Œç™‚ç™’ç³»é¢¨æ ¼',
                    é¡å‹: 'VIP',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$699',
                    é™æ™‚åƒ¹: '$499',
                    DriveID: '7StU8VwX9YzA0BcD1EfG2HiJ3KlM4NoP'
                },
                {
                    ç·¨ç¢¼: 'VIP-005',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/ff6347/ffffff?text=æ´»åŠ›æ©˜ç´…é¢¨',
                    é¢¨æ ¼åç¨±: 'æ´»åŠ›æ©˜ç´…é¢¨',
                    ç°¡çŸ­æè¿°: 'å……æ»¿æ´»åŠ›çš„æ©˜ç´…è‰²èª¿ï¼Œé©åˆé‹å‹•ç¾å®¹æˆ–å¹´è¼•æ™‚å°šå“ç‰Œ',
                    é¡å‹: 'VIP',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$699',
                    é™æ™‚åƒ¹: '$499',
                    DriveID: '8VwX9YzA0BcD1EfG2HiJ3KlM4NoP5QrS'
                },
                {
                    ç·¨ç¢¼: 'VIP-006',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/4169e1/ffffff?text=å°ˆæ¥­è—èª¿é¢¨',
                    é¢¨æ ¼åç¨±: 'å°ˆæ¥­è—èª¿é¢¨',
                    ç°¡çŸ­æè¿°: 'ç©©é‡å°ˆæ¥­çš„è—è‰²ç³»ï¼Œé©åˆé†«ç¾è¨ºæ‰€æˆ–é«˜ç«¯è­·è†šä¸­å¿ƒ',
                    é¡å‹: 'VIP',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$699',
                    é™æ™‚åƒ¹: '$499',
                    DriveID: '9YzA0BcD1EfG2HiJ3KlM4NoP5QrS6TuV'
                },
                // é™é‡ç‰ˆç¯„æœ¬
                {
                    ç·¨ç¢¼: 'LIMITED-001',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/ffb7c5/8b4513?text=æ˜¥å­£æ«»èŠ±ç‰ˆ',
                    é¢¨æ ¼åç¨±: 'æ˜¥å­£æ«»èŠ±ç‰ˆ',
                    ç°¡çŸ­æè¿°: 'ç²‰å«©æ«»èŠ±ä¸»é¡Œè¨­è¨ˆï¼Œé™æ™‚æ˜¥å­£ç‰¹åˆ¥ç‰ˆï¼Œå±•ç¾æµªæ¼«æ˜¥æ„',
                    é¡å‹: 'LIMITED',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$999',
                    é™æ™‚åƒ¹: '$699',
                    DriveID: '0BcD1EfG2HiJ3KlM4NoP5QrS6TuV7WxY'
                },
                {
                    ç·¨ç¢¼: 'LIMITED-002',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/87ceeb/ffffff?text=å¤æ—¥æµ·æ´‹ç‰ˆ',
                    é¢¨æ ¼åç¨±: 'å¤æ—¥æµ·æ´‹ç‰ˆ',
                    ç°¡çŸ­æè¿°: 'æ¸…æ¶¼æµ·æ´‹è—èª¿ï¼Œå¤å­£é™å®šç‰¹åˆ¥ç‰ˆï¼Œå¸¶ä¾†æ¸…æ–°æ¶¼æ„Ÿ',
                    é¡å‹: 'LIMITED',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$999',
                    é™æ™‚åƒ¹: '$699',
                    DriveID: '1CdE2FgH3IjK4LmN5OpQ6RsT7UvW8XyZ'
                },
                {
                    ç·¨ç¢¼: 'LIMITED-003',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/daa520/ffffff?text=ç§‹æ„é‡‘é»ƒç‰ˆ',
                    é¢¨æ ¼åç¨±: 'ç§‹æ„é‡‘é»ƒç‰ˆ',
                    ç°¡çŸ­æè¿°: 'æº«æš–é‡‘é»ƒè‰²èª¿ï¼Œç§‹å­£é™å®šç‰ˆï¼Œç‡Ÿé€ è±æ”¶èˆ‡æº«é¦¨æ°›åœ',
                    é¡å‹: 'LIMITED',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$999',
                    é™æ™‚åƒ¹: '$699',
                    DriveID: '2DfG3HiJ4KlM5NoP6QrS7TuV8WxY9ZaB'
                },
                // è¨­è¨ˆå¸«è¯åæ¬¾
                {
                    ç·¨ç¢¼: 'DESIGNER-001',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/4b0082/ffffff?text=è¨­è¨ˆå¸«è¯åæ¬¾A',
                    é¢¨æ ¼åç¨±: 'è—è¡“å¤§å¸«è¯åæ¬¾',
                    ç°¡çŸ­æè¿°: 'çŸ¥åè¨­è¨ˆå¸«è¯åå‰µä½œï¼Œç¨ç‰¹è—è¡“é¢¨æ ¼ï¼Œé™é‡ç™¼è¡Œçè—ç‰ˆ',
                    é¡å‹: 'DESIGNER',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$1999',
                    é™æ™‚åƒ¹: '$1499',
                    DriveID: '3EfG4HiJ5KlM6NoP7QrS8TuV9WxY0ZaB'
                },
                {
                    ç·¨ç¢¼: 'DESIGNER-002',
                    æª”æ¡ˆåç¨±: 'https://via.placeholder.com/400x266/800080/ffffff?text=è¨­è¨ˆå¸«è¯åæ¬¾B',
                    é¢¨æ ¼åç¨±: 'æ™‚å°šæ½®æµè¯åæ¬¾',
                    ç°¡çŸ­æè¿°: 'æ™‚å°šç•ŒçŸ¥åè¨­è¨ˆå¸«è·¨ç•Œåˆä½œï¼Œå‰è¡›æ½®æµè¨­è¨ˆç†å¿µ',
                    é¡å‹: 'DESIGNER',
                    ç”¢æ¥­: 'é€šç”¨',
                    åŸåƒ¹: '$1999',
                    é™æ™‚åƒ¹: '$1499',
                    DriveID: '4FgH5IjK6LmN7OpQ8RsT9UvW0XyZ1AbC'
                }
            ];
            
            templatesData = demoTemplates;
            renderTemplates(templatesData);
            document.getElementById('templates-loading').style.display = 'none';
        }

        // æ¸²æŸ“ç¯„æœ¬å¡ç‰‡
        function renderTemplates(templates) {
            const grid = document.getElementById('templates-grid');
            grid.innerHTML = '';

            templates.forEach(template => {
                const card = createTemplateCard(template);
                grid.appendChild(card);
            });

            // è¼‰å…¥å‹•ç•«
            const cards = document.querySelectorAll('.template-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // å»ºç«‹ç¯„æœ¬å¡ç‰‡
        function createTemplateCard(template) {
            const card = document.createElement('div');
            card.className = 'template-card';
            
            // æ ¹æ“šé¡å‹æ±ºå®šé»æ“Šè¡Œç‚º
            if (template.é¡å‹ === 'FREE') {
                card.onclick = () => downloadFree(template.DriveID);
            } else {
                card.onclick = () => verifyAndDownload(template.ç·¨ç¢¼);
            }

            // é¡å‹æ¨™ç±¤
            let badgeClass = '';
            let badgeText = '';
            switch(template.é¡å‹) {
                case 'FREE':
                    badgeClass = 'free';
                    badgeText = 'ğŸ FREE';
                    break;
                case 'VIP':
                    badgeClass = 'vip';
                    badgeText = 'ğŸ’ VIP';
                    break;
                case 'LIMITED':
                    badgeClass = 'limited';
                    badgeText = 'ğŸŒ¸ LIMITED';
                    break;
                case 'DESIGNER':
                    badgeClass = 'designer';
                    badgeText = 'âœ¨ DESIGNER';
                    break;
            }

            // åƒ¹æ ¼é¡¯ç¤º
            let priceHTML = '';
            if (template.é¡å‹ === 'FREE') {
                priceHTML = `<div class="price-info"><span class="free-price">å®Œå…¨å…è²»</span></div>`;
            } else {
                if (template.åŸåƒ¹ !== template.é™æ™‚åƒ¹) {
                    priceHTML = `
                        <div class="price-info">
                            <span class="original-price">${template.åŸåƒ¹}</span>
                            <span class="sale-price">é™æ™‚ ${template.é™æ™‚åƒ¹}</span>
                        </div>
                    `;
                } else {
                    priceHTML = `<div class="price-info"><span class="sale-price">${template.é™æ™‚åƒ¹}</span></div>`;
                }
            }

            // æŒ‰éˆ•
            let buttonHTML = '';
            if (template.é¡å‹ === 'FREE') {
                buttonHTML = `
                    <button class="download-btn">
                        <svg class="download-icon" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                            <path d="M12 15l-4-4h3V4h2v7h3l-4 4zm-8 3h16v2H4v-2z"/>
                        </svg>
                        ç«‹å³ä¸‹è¼‰
                    </button>
                `;
            } else {
                buttonHTML = `
                    <button class="premium-btn">
                        ${badgeText.split(' ')[0]} ä»˜è²»ä¸‹è¼‰
                    </button>
                `;
            }

            card.innerHTML = `
                <div class="type-badge ${badgeClass}">${badgeText}</div>
                <div class="template-preview">
                    <img src="${template.æª”æ¡ˆåç¨±}" alt="${template.é¢¨æ ¼åç¨±}" onload="this.parentElement.querySelector('::after') && (this.parentElement.style.setProperty('--after-display', 'none'))">
                </div>
                <div class="template-info">
                    <h3>${template.é¢¨æ ¼åç¨±}</h3>
                    <p>${template.ç°¡çŸ­æè¿°}</p>
                </div>
                ${priceHTML}
                ${buttonHTML}
            `;

            return card;
        }

        // å…è²»ä¸‹è¼‰
        function downloadFree(driveId) {
            const card = event.currentTarget;
            const btn = card.querySelector('.download-btn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<span>æº–å‚™ä¸‹è¼‰...</span>';
            btn.style.background = 'linear-gradient(135deg, #34ce57, #28a745)';
            
            // é–‹å•Ÿ Google Drive ä¸‹è¼‰é€£çµ
            const downloadUrl = `https://drive.google.com/uc?export=download&id=${driveId}`;
            window.open(downloadUrl, '_blank');
            
            // è¨˜éŒ„ä¸‹è¼‰çµ±è¨ˆ
            recordDownload('FREE', driveId, 'anonymous');
            
            // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = 'linear-gradient(135deg, #28a745, #34ce57)';
            }, 2000);
        }

        // ä»˜è²»ç¯„æœ¬é©—è­‰ä¸‹è¼‰
        function verifyAndDownload(templateCode) {
            currentTemplateCode = templateCode;
            const template = templatesData.find(t => t.ç·¨ç¢¼ === templateCode);
            
            if (template) {
                document.getElementById('modal-message').textContent = 
                    `è«‹è¼¸å…¥æ‚¨å·²è³¼è²·ã€Œ${template.é¢¨æ ¼åç¨±}ã€çš„ Email åœ°å€`;
            }
            
            document.getElementById('emailModal').style.display = 'block';
        }

        // Email é©—è­‰
        async function verifyEmail() {
            const email = document.getElementById('emailInput').value.trim();
            
            if (!email) {
                alert('è«‹è¼¸å…¥ Email åœ°å€');
                return;
            }

            if (!isValidEmail(email)) {
                alert('è«‹è¼¸å…¥æ­£ç¢ºçš„ Email æ ¼å¼');
                return;
            }

            try {
                // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
                const verifyBtn = document.querySelector('.modal-btn.primary');
                const originalText = verifyBtn.textContent;
                verifyBtn.textContent = 'é©—è­‰ä¸­...';
                verifyBtn.disabled = true;

                // å‘¼å« Google Apps Script é©—è­‰æ¬Šé™
                const response = await fetch(`${SHEETS_API_URL}?action=verifyPermission&email=${email}&templateCode=${currentTemplateCode}`);
                const data = await response.json();

                if (data.success && data.hasPermission) {
                    // æœ‰æ¬Šé™ï¼Œæä¾›ä¸‹è¼‰é€£çµ
                    const template = templatesData.find(t => t.ç·¨ç¢¼ === currentTemplateCode);
                    if (template) {
                        const downloadUrl = `https://drive.google.com/uc?export=download&id=${template.DriveID}`;
                        window.open(downloadUrl, '_blank');
                        
                        // è¨˜éŒ„ä¸‹è¼‰çµ±è¨ˆ
                        recordDownload(currentTemplateCode, template.DriveID, email);
                        
                        alert('ä¸‹è¼‰å·²é–‹å§‹ï¼æ„Ÿè¬æ‚¨çš„è³¼è²·ï¼');
                        closeModal();
                    }
                } else {
                    // æ²’æœ‰æ¬Šé™ï¼Œé¡¯ç¤ºè³¼è²·èªªæ˜
                    const template = templatesData.find(t => t.ç·¨ç¢¼ === currentTemplateCode);
                    document.getElementById('purchase-price').textContent = 
                        `${template.é¢¨æ ¼åç¨±} ${template.é™æ™‚åƒ¹}`;
                    
                    closeModal();
                    document.getElementById('purchaseModal').style.display = 'block';
                }

                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                verifyBtn.textContent = originalText;
                verifyBtn.disabled = false;

            } catch (error) {
                console.error('é©—è­‰éŒ¯èª¤:', error);
                alert('é©—è­‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
                
                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                const verifyBtn = document.querySelector('.modal-btn.primary');
                verifyBtn.textContent = 'é©—è­‰ä¸‹è¼‰';
                verifyBtn.disabled = false;
            }
        }

        // è¨˜éŒ„ä¸‹è¼‰çµ±è¨ˆ
        async function recordDownload(templateCode, driveId, email) {
            try {
                await fetch(`${SHEETS_API_URL}?action=recordDownload&templateCode=${templateCode}&driveId=${driveId}&email=${email}`);
            } catch (error) {
                console.error('è¨˜éŒ„ä¸‹è¼‰çµ±è¨ˆå¤±æ•—:', error);
            }
        }

        // å…è²»å½±ç‰‡è§€çœ‹
        function watchFreeVideo(videoId) {
            // é€™è£¡å¯ä»¥æ”¾ç½®å…è²»æ•™å­¸å½±ç‰‡çš„é€£çµ
            const videoUrls = {
                'basic-setup': 'https://www.youtube.com/watch?v=your_video_id1',
                'menu-upload': 'https://www.youtube.com/watch?v=your_video_id2'
            };
            
            if (videoUrls[videoId]) {
                window.open(videoUrls[videoId], '_blank');
            } else {
                alert('å½±ç‰‡æº–å‚™ä¸­ï¼Œæ•¬è«‹æœŸå¾…ï¼');
            }
        }

        // ä»˜è²»å½±ç‰‡é©—è­‰è§€çœ‹
        function verifyAndWatchVideo(tutorialCode) {
            currentTemplateCode = tutorialCode;
            document.getElementById('modal-message').textContent = 
                `è«‹è¼¸å…¥æ‚¨å·²è³¼è²·æ­¤æ•™å­¸èª²ç¨‹çš„ Email åœ°å€`;
            document.getElementById('emailModal').style.display = 'block';
        }

        // è¯çµ¡æœå‹™
        function contactService(serviceType) {
            const serviceMessages = {
                'custom-design': 'æˆ‘æƒ³äº†è§£å®¢è£½è¨­è¨ˆæœå‹™',
                'setup-service': 'æˆ‘æƒ³é ç´„å°ˆäººå”åŠ©è¨­å®šæœå‹™',
                'consulting': 'æˆ‘æƒ³äº†è§£ç‡Ÿé‹è«®è©¢æœå‹™'
            };
            
            const message = serviceMessages[serviceType] || 'æˆ‘æƒ³äº†è§£æœå‹™å…§å®¹';
            const lineUrl = `https://line.me/R/ti/p/${LINE_OFFICIAL_ID}?message=${encodeURIComponent(message)}`;
            window.open(lineUrl, '_blank');
        }

        // åŠ å…¥LINEå®˜æ–¹
        function addLineOfficial() {
            const lineUrl = `https://line.me/R/ti/p/${LINE_OFFICIAL_ID}`;
            window.open(lineUrl, '_blank');
            closePurchaseModal();
        }

        // é—œé–‰ Email é©—è­‰å½ˆçª—
        function closeModal() {
            document.getElementById('emailModal').style.display = 'none';
            document.getElementById('emailInput').value = '';
            currentTemplateCode = '';
        }

        // é—œé–‰è³¼è²·èªªæ˜å½ˆçª—
        function closePurchaseModal() {
            document.getElementById('purchaseModal').style.display = 'none';
        }

        // Email æ ¼å¼é©—è­‰
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
        function showError(message) {
            document.getElementById('templates-loading').innerHTML = `
                <p style="color: #e74c3c;">${message}</p>
                <button onclick="loadTemplates()" style="margin-top: 15px; padding: 10px 20px; background: #8b4513; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    é‡æ–°è¼‰å…¥
                </button>
            `;
        }

        // é»æ“Šå½ˆçª—å¤–éƒ¨é—œé–‰
        window.onclick = function(event) {
            const emailModal = document.getElementById('emailModal');
            const purchaseModal = document.getElementById('purchaseModal');
            
            if (event.target === emailModal) {
                closeModal();
            }
            if (event.target === purchaseModal) {
                closePurchaseModal();
            }
        }

        // Enter éµé©—è­‰
        document.getElementById('emailInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                verifyEmail();
            }
        });
    </script>
</body>
</html>
